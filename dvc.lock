schema: '2.0'
stages:
  db_to_feather:
    cmd: "python mbti_type_from_text/cli/dvc_stages/db_to_feather.py --db_path data/raw/reddit.db\
      \ --users_feather_path data/processed/users.feather --comments_feather_path\
      \ data/processed/comments.feather\n"
    deps:
    - path: data/raw/reddit.db
      md5: 19cf1375e8d1d785b2a8e28ae2809352
      size: 305807360
    - path: mbti_type_from_text/cli/dvc_stages/db_to_feather.py
      md5: c376ac1c3e40463d63d1b1f1ee2447b8
      size: 1949
    outs:
    - path: data/processed/comments.feather
      md5: 32daa31316df07f013f3722adc3d6a50
      size: 255785010
    - path: data/processed/users.feather
      md5: df86bd9b7d230f510b4322d5b36ab9a8
      size: 410938
  extract_mbti:
    cmd: "python mbti_type_from_text/cli/dvc_stages/extract_mbti.py --users_feather_path\
      \ data/processed/users.feather --comments_feather_path data/processed/comments.feather\
      \ --users_mbti_feather_path data/processed/mbti_per_user.feather\n"
    deps:
    - path: data/processed/comments.feather
      md5: 32daa31316df07f013f3722adc3d6a50
      size: 255785010
    - path: data/processed/users.feather
      md5: df86bd9b7d230f510b4322d5b36ab9a8
      size: 410938
    - path: mbti_type_from_text/cli/dvc_stages/extract_mbti.py
      md5: 314657b117b86325a8c1f8a32eb2109a
      size: 5458
    outs:
    - path: data/processed/mbti_per_user.feather
      md5: eb0830c9d46dcf4857852d13b0e09130
      size: 189890
  compute_statistics_and_tokens_per_user:
    cmd: "python  mbti_type_from_text/cli/dvc_stages/compute_statistics_and_tokens_per_user.py\
      \ --comments_feather_path data/processed/comments.feather --stats_per_user_path\
      \ data/processed/stats_per_user.feather --tokens_per_user_path data/processed/tokens_per_user.feather\n"
    deps:
    - path: data/processed/comments.feather
      md5: 32daa31316df07f013f3722adc3d6a50
      size: 255785010
    - path: mbti_type_from_text/cli/dvc_stages/compute_statistics_and_tokens_per_user.py
      md5: 6b81c9fd4ff245921c5c6954b769aadd
      size: 9205
    outs:
    - path: data/processed/stats_per_user.feather
      md5: 884de822e19094c2bd350f47b3d77893
      size: 1742082
    - path: data/processed/tokens_per_user.feather
      md5: 46ad430097b2d3d59c617d4fe087f072
      size: 118210026
  plot_statistics_per_user_with_umap:
    cmd: "python mbti_type_from_text/cli/dvc_stages/plot_statistics_per_user_with_umap.py\
      \ --stats_per_user_path data/processed/stats_per_user.feather --users_mbti_feather_path\
      \ data/processed/mbti_per_user.feather --plot_path plots/stats_per_user_umap.html\n"
    deps:
    - path: data/processed/mbti_per_user.feather
      md5: eb0830c9d46dcf4857852d13b0e09130
      size: 189890
    - path: data/processed/stats_per_user.feather
      md5: 884de822e19094c2bd350f47b3d77893
      size: 1742082
    - path: mbti_type_from_text/cli/dvc_stages/plot_statistics_per_user_with_umap.py
      md5: 1f0c7ae5f5246a1d246164ff0b0a6cf6
      size: 2340
    outs:
    - path: plots/stats_per_user_umap.html
      md5: d7566f8959eab9ee2a7d80782dcda065
      size: 4304621
  cross_validate@random_forest_mbti_by_dichotomy:
    cmd: "python mbti_type_from_text/cli/dvc_stages/cross_validate.py --stats_per_user_path\
      \ data/processed/stats_per_user.feather --tokens_per_user_path data/processed/tokens_per_user.feather\
      \ --users_mbti_feather_path data/processed/mbti_per_user.feather --global_config_path\
      \ config/params.json --classifier_import_path mbti_type_from_text.models.random_forest.RandomForestMBTIByDichotomyClassifier\
      \ --classifier_config_path config/classifiers/random_forest_mbti_by_dichotomy.json\
      \ --metrics_path metrics/random_forest_mbti_by_dichotomy.json\n"
    deps:
    - path: data/processed/mbti_per_user.feather
      md5: eb0830c9d46dcf4857852d13b0e09130
      size: 189890
    - path: data/processed/stats_per_user.feather
      md5: 884de822e19094c2bd350f47b3d77893
      size: 1742082
    - path: mbti_type_from_text/cli/dvc_stages/cross_validate.py
      md5: cae27ce471bcfea59a7d59b3d4df0190
      size: 5178
    - path: mbti_type_from_text/models/base.py
      md5: 193f39d7c9e0fff41d23f22709e99f6f
      size: 4815
    - path: mbti_type_from_text/models/random_forest.py
      md5: 3426345e69b731b9f351e359dc213d88
      size: 479
    params:
      config/classifiers/random_forest_mbti_by_dichotomy.json:
        hyper_parameters:
          n_estimators: 100
          random_state: 42
        tokens_tfidf_vectorizer:
          max_features: 10000
      config/params.json:
        cross_validate:
          k_fold:
            n_splits: 5
            shuffle: true
            random_state: 42
    outs:
    - path: metrics/random_forest_mbti_by_dichotomy.json
      md5: c1378312271401061558dc2860f17e75
      size: 64
  cross_validate@random_forest_mbti_type:
    cmd: "python mbti_type_from_text/cli/dvc_stages/cross_validate.py --stats_per_user_path\
      \ data/processed/stats_per_user.feather --tokens_per_user_path data/processed/tokens_per_user.feather\
      \ --users_mbti_feather_path data/processed/mbti_per_user.feather --global_config_path\
      \ config/params.json --classifier_import_path mbti_type_from_text.models.random_forest.RandomForestMBTITypeClassifier\
      \ --classifier_config_path config/classifiers/random_forest_mbti_type.json --metrics_path\
      \ metrics/random_forest_mbti_type.json\n"
    deps:
    - path: data/processed/mbti_per_user.feather
      md5: eb0830c9d46dcf4857852d13b0e09130
      size: 189890
    - path: data/processed/stats_per_user.feather
      md5: 884de822e19094c2bd350f47b3d77893
      size: 1742082
    - path: mbti_type_from_text/cli/dvc_stages/cross_validate.py
      md5: cae27ce471bcfea59a7d59b3d4df0190
      size: 5178
    - path: mbti_type_from_text/models/base.py
      md5: 193f39d7c9e0fff41d23f22709e99f6f
      size: 4815
    - path: mbti_type_from_text/models/random_forest.py
      md5: 3426345e69b731b9f351e359dc213d88
      size: 479
    params:
      config/classifiers/random_forest_mbti_type.json:
        hyper_parameters:
          n_estimators: 100
          random_state: 42
        tokens_tfidf_vectorizer:
          max_features: 10000
      config/params.json:
        cross_validate:
          k_fold:
            n_splits: 5
            shuffle: true
            random_state: 42
    outs:
    - path: metrics/random_forest_mbti_type.json
      md5: 9148365ae099f3f86e0ef4dcca7b5eae
      size: 65
